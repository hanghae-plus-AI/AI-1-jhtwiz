6주차때 Gemma-2-2b로 진행하려 했으나 메모리 부족으로 gpt2를 이용했기에 이번에 Gemma-2-2b를 사용해 봤습니다.

2b짜리가 T4에서 돌리기에는 너무 큰지 Q-Lora와 deepspeed config_stage3를 적용해야 학습이 가능했으며,

6주차때 진행한 GPT-2 SFT는 25319개로 이루어진 데이터셋으로 학습하였으나 gemma-2-2b에서는 시간 소요가 너무 오래걸려 학습이 가능한지에 초점을 맞춰 진행하기 위해 GPT-2, Gemma-2-2b에 1967개짜리 데이터셋으로 학습하였습니다.

### GPT-2 SFT(1967개 dataset) 후 ouput
```
### Question: 고혈압에 대해서 알려줘
### Answer: 고혈압은 고혈압에 대해서 알려줘 있습니다. 고혈압은 고혈압은 알려줘 있습니다. 고혈압은 알려줘 있습니다.
고혈압은 알려줘 있습니다. 고혈압은 알려줘 있습니다. 고혈압은 알려줘 있습니다. 고혈압은 알려줘 있습니다. 고혈압은 알려줘 있습니다.
고혈압은 알려줘 있습니다. 고혈압은 알려줘 있습니다. 고혈압은 알려줘 있습니다. 고혈압은 알려줘 있습니다. 고혈압은 알려줘 있습니다. 고혈압은 알려줘 있습
```
### Gemma-2-2b(1967개 dataset) SFT 후 output
```
'user: 고혈압에 대해서 알려줘요.
고혈압은 혈압이 140/90 mmHg 이상으로 높아지는 상태를 말합니다.
이는 심장과 혈관에 부정적인 영향을 미치며, 심근경색, 뇌졸중 등의 심각한 합병증을 일으킬 수 있습니다.
고혈압은 일반적으로 혈압을 측정하는 기기로 확인할 수 있습니다. 이를 통해 정확한 진단을 받을 수 있습니다.
고혈압은 심각한 합병증을 일으킬 수 있는 질환으로, 정기적인 혈압 측정과 관리가 필요합니다.
고혈압을 예방하고 관리하기 위해서는 건강한 식습관과 운동을 유지하는 것이 중요합니다.
또한, 정기적인 혈압 측정과 관리를 통해 합병증을 예방할 수 있습니다.
고혈압은 심각한 합병증을 일으킬 수 있는 질환으로, 정기적인 혈압 측정과 관리가 필요합니다.
건강한 식습관과 운동을 유지하며, 정기적인 혈압 측정과 관리를 통해 합병증을 예방할 수 있습니다.
고혈압은 심각한 합병증을 일으킬 수 있는 질환으로, 정기적인 혈압 측정과 관리가 필요합니다.
건강한 식습관과 운동을 유지하며, 정기적인 혈압 측정과 관리를 통해 합병증을 예방할 수 있습니다.
고혈압은 심각한 합병증을 일으킬 수 있는 질환으로, 정기적인 혈압 측정과 관리가 필요합니다.
건강한 식습관과 운동을 유지하며, 정기적인 혈압 측정과 관리를 통해 합병증을 예방할 수 있습니다.
고혈압은 심각한 합병증을 일으킬 수 있는 질환으로, 정기적인 혈압 측정과 관리가 필요합니다.
건강한 식습관과 운동을 유지하며, 정기적인 혈압 측정과 관리를 통해 합병증을 예방할 수 있습니다.
고혈압은 심각한 합병증을 일으킬 수 있는 질환으로, 정기적인 혈압 측'
```

### 참고: GPT-2 SFT(25319개 dataset) 후 ouput
```
### Question: 고혈압에 대해서 알려줘
### Answer: 고혈압은 혈압이 정상 범위를 벗어나는 상태를 말합니다.
고혈압은 심장, 관절, 피부, 뇌 등의 증상을 동반할 수 있습니다.
고혈압은 심장의 혈관이 저하되어 심장 기능을 저하시키고, 심부전, 관절, 피부, 뇌 등의 증상을 동반할 수 있습니다.
이러한 증상은 심장 기능을 저하시키고, 심부전, 관절, 피부, 뇌 등의 증상을 동반할 수 있습니다. 고혈압은 심장 기능을 저하시키고, 심부전, 관절, 피부, 뇌 등의 증상을 동반할
```

같은 데이터셋으로 학습했을 경우 GPT-2의 경우 적은 dataset으로 인해서 그런지 학습이 아예 진행되지 않은 듯한 모습을 보였습니다.

Gemma-2-2b에서 반복적이고 이상한 말들이 많이 나오지만 관련된 내용이 어느정도 나오는걸 봐서 학습이 진행된 것으로 보입니다.

25319개 dataset으로 학습한 GPT-2의 경우에도 어느정도 관련된 내용을 보여주는것으로 보아 경량화한 큰 LLM에 같은 데이터셋을 넣어줬다면 훨씬 더 좋은 결과를 보여주지 않았을까 생각합니다.

## 추가
Wandb로 GPU Memory로 확인해본 결과 약간의 메모리가 있어서 Lora Rank를 128로 추가 진행.

### Gemma-2-2b Rank 128 SFT 후 output
```
user: 고혈압에 대해서 알려줘요. 고혈압은 혈압이 140/90mmHg 이상으로 높아지는 상태를 말합니다.
이는 심장과 혈관에 장애를 일으키는 위험성을 가지고 있습니다. 고혈압은 심장과 혈관에 장애를 일으키는 위험성을 가지고 있습니다.
이로 인해 고혈압은 심장병, 뇌졸중, 혈관 질환 등 다양한 합병증을 일으킬 수 있습니다.
따라서, 고혈압은 심장과 혈관에 장애를 일으키는 위험성을 가지고 있습니다.
이를 예방하기 위해서는 적절한 식습관과 운동을 유지하는 것이 중요합니다. 또한, 약물 치료도 고혈압의 치료에 도움이 될 수 있습니다.
고혈압은 심장과 혈관에 장애를 일으키는 위험성을 가지고 있습니다. 이를 예방하기 위해서는 적절한 식습관과 운동을 유지하는 것이 중요합니다. 또한, 약물 치료도 고혈압의 치료에 도움
```
